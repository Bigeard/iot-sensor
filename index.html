<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Temp</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.4.0/Chart.min.js"></script>
  </head>
  <body>
    <p>temperature: <span id="temperature">0</span> °C</p>
    <p>humidity: <span id="humidity">0</span> °%</p>
    <p>date: <span id="date">0</span></p>

    <canvas id="tempChart"></canvas>

    <script src="/socket.io/socket.io.js"></script>
    <script>
      window.onload = function() {
        var socket = io();
        var temperature = document.getElementById("temperature");
        var humidity = document.getElementById("humidity");
        var date = document.getElementById("date");
        var ctx = document.getElementById("tempChart").getContext("2d");

        socket.on("data", function(dataSok) {
          console.log(dataSok);
          temperature.innerHTML = dataSok[0].temperature;
          humidity.innerHTML = dataSok[0].humidity;
          date.innerHTML = dataSok[0].date;
          console.log(dataSok);

          var chart = new Chart(ctx, {
            // The type of chart we want to create
            type: "line",

            // The data for our dataset
            data: {
              labels: [
                dataSok[7].date,
                dataSok[5].date,
                dataSok[4].date,
                dataSok[3].date,
                dataSok[2].date,
                dataSok[1].date,
                dataSok[0].date
              ],
              datasets: [
                {
                  label: "Temperature",
                  backgroundColor: "rgb(255, 99, 132, 0.5)",
                  borderColor: "rgb(255, 99, 132, 0.5)",
                  data: [
                    dataSok[7].temperature,
                    dataSok[5].temperature,
                    dataSok[4].temperature,
                    dataSok[3].temperature,
                    dataSok[2].temperature,
                    dataSok[1].temperature,
                    dataSok[0].temperature
                  ]
                },
                {
                  label: "Humidity",
                  backgroundColor: "rgb(99, 255, 132, 0.5)",
                  borderColor: "rgb(99, 255, 132, 0.5)",
                  data: [
                    dataSok[7].humidity,
                    dataSok[5].humidity,
                    dataSok[4].humidity,
                    dataSok[3].humidity,
                    dataSok[2].humidity,
                    dataSok[1].humidity,
                    dataSok[0].humidity
                  ]
                }
              ]
            },

            // Configuration options go here
            options: {
              animation: false,
              scales: {
                yAxes: [
                  {
                    ticks: {
                      beginAtZero: true,
                      suggestedMax: 50
                    }
                  }
                ]
              }
            }
          });
        });
      };
    </script>
  </body>
</html>
